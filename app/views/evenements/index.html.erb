<section id="image-entete" class="pure-u-1"> </section>

<section id="liste-evenements" class="pure-g">
    <div id="entete-evenements" class="pure-u-1">
        <h2 class="pure-u-1 pure-u-md-3-24">Événements</h2>
        <div id="recherche" class="pure-u-md-5-24">
            <form><input id="champ-recherche" type="text"></form>
        </div>
    </div>

    <div id="filtre-evenements" class="pure-u-1">
        <h3 class="">Catégories</h3>
        <ul>
            <% Evenement::categories.each do |cat| %>
                <li class="filtre-categorie"><%= cat.first %></li>
            <% end %>
        </ul>
    </div>
    <div id="themes-evenements" class="pure-u-1">
        <ul>
            <% (0..10).each do |mois| %>
                <li><%= l(Date.today.advance(:months => mois), format: :mois) %></li>
            <% end %>
        </ul>
    </div>

    <div id="evenements-prochain-mois" class="pure-u-1">
        <h2><%= l(@evenements.first.date, format: :ma) %> | <%= @evenements.count %> événements</h2>
    </div>

    <div id="evenements-items" class="pure-g">
        <% @evenements.each do |evenement| %>
            <article class="evenement pure-u-1 pure-u-md-1-3">
                <div class="container-evenement">
                    <div class="image-evenement">
                        <%= link_to(image_tag(image_show_path evenement.image_id), evenement) %>
                        <div class="categorie-evenement" data-categorie="<%= evenement.categorie %>" style="background-color: red"></div>
                    </div>
                    <div class="informations-evenement pure-g">
                        <% if @user and @user.niveau_admin > 1 %>
                            <div class="administration-evenement pure-u-1">
                                <%= link_to 'Modifier', edit_evenement_path(evenement) %>
                                <%= link_to 'Supprimer', evenement, method: :delete, data: { confirm: 'La suppression est irréversisble. Continuer?' } %>
                            </div>
                        <% end %>
                        <h3 class="nom-evenement pure-u-1"><%= evenement.nom %></h3>
                        <p class="description-evenement pure-u-1"><%= evenement.description %></p>
                        <div class="date-evenement pure-u-1-2">
                            <p><%= l(evenement.date, format: :jour_semaine) %> <b><%= evenement.date.day %></b> <%= l(evenement.date, format: :mois) %> </p>
                        </div>
                        <div class="heure-evenement pure-u-1-2">
                            <p>À <b><%= l(evenement.date, format: :heure) %>h<%= l(evenement.date, format: :minutes) %></b></p>
                        </div>
                    </div>
                </div>
            </article>
        <% end %>
    </div>
</section>

<% if @user and @user.niveau_admin >= 0 %>
    <section class="pure-u-1" style="text-align: center; padding: 15px; background-color: rgb(135, 135, 135);">
        <%= link_to 'Créer un événement', new_evenement_path %>
    </section>
<% end %>

<script>
$(document).ready(function () {
    $(".evenement .image-evenement").each(function (i, e) {
        var demie_hauteur_image = e.firstElementChild.firstElementChild.height / 2; 
        e.style.marginBottom = -demie_hauteur_image + "px";
        e.nextElementSibling.style.paddingTop = demie_hauteur_image + "px";
    });
});
</script>
